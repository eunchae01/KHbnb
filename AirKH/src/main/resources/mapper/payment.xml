<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.air.cwc.PaymentDAO">

	<insert id="addpayment" parameterType="com.air.cwc.PaymentDTO">
		<selectKey resultType="int" keyProperty="cart_num"
			order="BEFORE">
			select nvl(max(cart_num), 0) from payment_hotel
		</selectKey>

		insert into payment_hotel values(#{cart_num} + 1, #{acc_code},
		#{acc_name},
		#{acc_price}, #{acc_thumbnail},#{acc_addr}, #{check_in}, #{check_out},
		#{check_person},
		#{member_name}, #{member_phone}, #{host_name}, #{host_phone}, #{reserve_info},
		#{card_num},#{exprie},#{cvv},#{zip_code},#{country},
		sysdate
		)
	</insert>

	<select id="paylist" parameterType="String"
		resultType="com.air.cwc.PaymentDTO">
		select * from payment_hotel where member_name=#{member_id}
		order by check_in
	</select>

	<select id="Hpaylist" parameterType="String"
		resultType="com.air.cwc.PaymentDTO">
		<![CDATA[
		select * from payment_hotel where host_name=#{host_name} and check_out > to_char(SYSDATE-1,'YYYY/MM/DD') order by check_in
		]]>
	</select>

	<select id="out_list" parameterType="String"
		resultType="com.air.cwc.PaymentDTO">
		select * from payment_hotel where host_name=#{host_name} and reserve_info='1' and
		(check_out= to_char(SYSDATE,'YYYY/MM/DD') or check_out= to_char(SYSDATE+1,'YYYY/MM/DD')) order by check_in
		
	</select>

	<select id="in_list" parameterType="String"
		resultType="com.air.cwc.PaymentDTO">
		select * from payment_hotel where host_name=#{host_name} and reserve_info='1' and
		(check_in= to_char(SYSDATE,'YYYY/MM/DD') or check_in= to_char(SYSDATE+1,'YYYY/MM/DD')) order by check_in

	</select>

	<select id="pre_list" parameterType="String"
		resultType="com.air.cwc.PaymentDTO">
		<![CDATA[
		select * from payment_hotel where host_name=#{host_name} and reserve_info='1' and
		check_in > to_char(SYSDATE+2,'YYYY/MM/DD') order by check_in
		]]>
	</select>

	<select id="approve_list" parameterType="String"
		resultType="com.air.cwc.PaymentDTO">
		select * from payment_hotel where host_name=#{host_name}
		AND (reserve_info='0'or reserve_info='2') order by check_in
	</select>



	<select id="acc_host" resultType="com.air.cec.HostHotelDTO"
		parameterType="int">
		select * from host_hotel where host_num = #{acc_host}
	</select>

	<delete id="del_cart" parameterType="int">
		delete from payment_hotel
		where cart_num=#{cart_num}
	</delete>

	<select id="cart_cont" parameterType="int"
		resultType="com.air.cwc.PaymentDTO">
		select * from payment_hotel where cart_num = #{cart_num}
	</select>

	<update id="modify" parameterType="com.air.cwc.PaymentDTO">
		update payment_hotel set
		acc_price=#{acc_price}, check_in=#{check_in}, cart_num=#{check_out},
		check_person=#{check_person}, member_phone=#{member_phone},
		reserve_info=#{reserve_info},
		card_num=#{card_num},exprie=#{exprie},cvv=#{cvv},zip_code=#{zip_code},
		country=#{country},
		where cart_num =#{cart_num}
	</update>
	
	<update id="approve">
	update payment_hotel set reserve_info='1' where cart_num=#{cart_num}
	</update>
</mapper>
